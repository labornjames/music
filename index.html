<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç‰¹åˆ«çš„ç¥ç¦ ğŸ’–</title>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');
  body {
    margin: 0;
    height: 100vh;
    background: white;
    overflow: hidden;
    font-family: 'Pacifico', cursive;
    position: relative;
  }

  /* ğŸŒ¸ å¼¹çª—èƒŒæ™¯ */
  .overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(255, 192, 203, 0.4);
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
    z-index: 100;
  }

  /* ğŸŒ¸ å¼¹çª—ä¸»ä½“ */
  .popup {
    background: #fff0f6;
    padding: 30px 40px;
    border-radius: 25px;
    text-align: center;
    box-shadow: 0 0 30px rgba(255, 100, 150, 0.3);
    animation: popIn 0.8s ease;
  }

  @keyframes popIn {
    from { transform: scale(0.5); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  .popup h2 {
    color: #ff4f7d;
    margin-bottom: 20px;
    font-size: 26px;
  }

  .popup button {
    padding: 12px 30px;
    background: #ff7da8;
    color: white;
    border: none;
    border-radius: 25px;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(255, 122, 150, 0.6);
    transition: 0.3s;
  }

  .popup button:hover {
    background: #ff5e91;
    box-shadow: 0 0 30px rgba(255, 92, 140, 0.8);
  }

  /* ğŸ’Œ å°å¡ç‰‡æ ·å¼ */
  .wish {
    position: absolute;
    color: #333;
    font-size: 18px;
    font-weight: 600;
    opacity: 0;
    width: 180px;
    height: 80px;
    line-height: 80px;
    text-align: center;
    border-radius: 18px;
    border: 1px solid rgba(255, 150, 180, 0.3);
    box-shadow: 0 4px 10px rgba(255, 150, 170, 0.3);
    animation: fadeIn 1s ease forwards;
    transition: all 5s ease-in-out;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0 10px;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.4) rotate(-10deg); }
    to { opacity: 1; transform: scale(1) rotate(0deg); }
  }

  /* ğŸ’“ å¿ƒè·³åŠ¨ç”» */
  @keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    25% { transform: scale(1.04); }
    50% { transform: scale(0.98); }
    75% { transform: scale(1.05); }
  }

  /* ğŸ’ ä¸­å¿ƒä¸»å¡ç‰‡ */
  .center-heart {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-60%, -50%) scale(0);
    width: 240px;
    height: 120px;
    line-height: 120px;
    text-align: center;
    background: linear-gradient(180deg, #ffe5ef, #fff7fa);
    border-radius: 24px;
    box-shadow: 0 6px 20px rgba(255, 120, 160, 0.4);
    color: #ff4f7d;
    font-size: 24px;
    font-weight: 700;
    opacity: 0;
    animation: showCenter 1s ease forwards;
    animation-delay: 1s;
  }

  @keyframes showCenter {
    to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
  }
</style>
</head>

<body>

<!-- ğŸŒ¸ å¼¹çª— -->
<div class="overlay" id="overlay">
  <div class="popup">
    <h2>ğŸ ä½ æ”¶åˆ°ä¸€ä»½ç‰¹åˆ«çš„ç¤¼ç‰©</h2>
    <button id="acceptBtn">æ¥å— ğŸ’–</button>
  </div>
</div>

<!-- ğŸŒ¸ éŸ³ä¹ -->
<audio 
  id="music" 
  src="https://cdn.jsdelivr.net/gh/labornjames/music/%E9%98%BF%E5%86%97%20-%20%E4%B8%8E%E6%88%91%E6%97%A0%E5%85%B3_L.mp3"
  preload="auto"
  playsinline
  webkit-playsinline
></audio>

<script>
const wishes = [
  "ä¿æŒå¥½å¿ƒæƒ…", "çæƒœæ¯ä¸€åˆ»", "ä½ è¶…æ£’çš„", "æ—©ç‚¹ä¼‘æ¯", "æˆ‘æƒ³ä½ äº†",
  "æ¢¦æƒ³æˆçœŸ", "å¤©å†·äº†ï¼Œå¤šç©¿è¡£æœ", "é¡ºé¡ºåˆ©åˆ©", "è¦ç›¸ä¿¡è‡ªå·±å“¦",
  "åˆ«å¤ªç´¯å•¦", "ä½ æ˜¯æœ€æ£’çš„", "è®°å¾—å¥½å¥½æŠ¤è‚¤","å¿ƒæƒ³äº‹æˆ",
  "ä¿æŒå¾®ç¬‘å‘€", "æ„¿æ‰€æœ‰çƒ¦æ¼éƒ½æ¶ˆå¤±", "çˆ±äººå…ˆçˆ±å·±","ä¸€è·¯ç”ŸèŠ±","æ²¡æœ‰ä»€ä¹ˆå¯ä»¥éš¾å€’ä½ ",
  "å¸Œæœ›æ¯ä¸€å¤©éƒ½é—ªé—ªå‘å…‰", "ç¥ä½ ä»Šå¤©ä¹Ÿå…ƒæ°”æ»¡æ»¡", "å¥½è¿å¸¸ä¼´", "æ¢¦æƒ³å¼€èŠ±"
];

const overlay = document.getElementById('overlay');
const acceptBtn = document.getElementById('acceptBtn');
const music = document.getElementById('music');
const startTime = 97;
const endTime = 161;

// ğŸŒˆ éšæœºæŸ”å’Œé¢œè‰²èƒŒæ™¯
const gradients = [
  ['#ffe5ef', '#fff7fa'],
  ['#e0f7fa', '#f0ffff'],
  ['#fff9e6', '#fff3cc'],
  ['#f5e6ff', '#f0d9ff'],
  ['#e6fff2', '#d9ffee']
];

// iOS éŸ³é¢‘é¢„è§£é”
document.body.addEventListener('touchstart', function unlockAudio() {
  music.play().then(() => music.pause());
  document.body.removeEventListener('touchstart', unlockAudio);
});

acceptBtn.addEventListener("click", async () => {
  overlay.style.display = 'none';
  try {
    music.currentTime = startTime;
    await music.play();
  } catch (e) {
    console.log("æ’­æ”¾è¢«é˜»æ­¢", e);
  }

  // âœ… å¾ªç¯æ’­æ”¾ç‰‡æ®µ
  setInterval(() => {
    if (music.currentTime >= endTime) {
      music.currentTime = startTime;
      music.play();
    }
  }, 200);

  // ğŸŒ¸ å¼€å§‹æ˜¾ç¤ºç¥ç¦å¡ç‰‡
  startWishes();
});

// ğŸ’Œ åŠ¨ç”»ï¼šå¡ç‰‡å¼¹å‡ºåèšåˆæˆå¿ƒå½¢
function startWishes() {
  let count = 0;
  const total = 300; // ğŸ’¡ å¡ç‰‡æ•°é‡
  const interval = setInterval(() => {
    const wish = document.createElement('div');
    wish.className = 'wish';
    wish.textContent = wishes[Math.floor(Math.random() * wishes.length)];

    const [c1, c2] = gradients[Math.floor(Math.random() * gradients.length)];
    wish.style.background = `linear-gradient(180deg, ${c1}, ${c2})`;

    // éšæœºåˆå§‹ä½ç½®
    wish.style.left = Math.random() * window.innerWidth + 'px';
    wish.style.top = Math.random() * window.innerHeight + 'px';
    document.body.appendChild(wish);

    count++;
    if (count > total) {
      clearInterval(interval);
      setTimeout(formHeart, 3000); // ğŸ’— å…¨éƒ¨å‡ºç°åèšæˆå¿ƒå½¢
    }
  }, 150);
}

// ğŸ’— å¿ƒå½¢èšåˆå‡½æ•°
function formHeart() {
  const cards = document.querySelectorAll('.wish');
  const centerX = window.innerWidth / 2;
  const centerY = window.innerHeight / 2;
  const scale = 25;

  cards.forEach((card, i) => {
    const t = Math.PI * 2 * (i / cards.length);
    const x = 16 * Math.sin(t) ** 3;
    const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);

    const targetX = centerX + x * scale;
    const targetY = centerY - y * scale;
    card.style.transition = "all 5s ease-in-out";
    card.style.left = `${targetX - 90}px`;
    card.style.top = `${targetY - 50}px`;
    card.style.opacity = 1;
  });

  // ğŸ’“ æ·»åŠ å¿ƒè·³åŠ¨ç”»ï¼Œä¿æŒæœ€ç»ˆç”»é¢
  setTimeout(() => {
    cards.forEach(c => c.style.animation = "heartbeat 2.5s infinite ease-in-out");
    showCenterHeart(); // ğŸŒŸ æ·»åŠ ä¸­å¿ƒå¡ç‰‡
  }, 6000);
}

// ğŸ’ ä¸­å¿ƒç¥ç¦å‡ºç°
function showCenterHeart() {
  const center = document.createElement('div');
  center.className = 'center-heart';
  center.textContent = 'ğŸ’Œ å¸Œæœ›ä½ å¤©å¤©å¼€å¿ƒ';
  document.body.appendChild(center);
  center.style.animation = "showCenter 2s ease forwards, heartbeat 3s infinite ease-in-out 2s";
}
</script>

</body>
</html>
